<view class="container fade-in" style="--theme-color: {{themeColor}}">
  <!-- åº†ç¥åŠ¨ç”» -->
  <view class="celebration-overlay {{showCelebration ? 'show' : ''}}" wx:if="{{showCelebration}}">
    <view class="celebration-content">
      <view class="celebration-icon">ğŸ‰</view>
      <view class="celebration-text">ç›®æ ‡è¾¾æˆï¼</view>
      <view class="confetti-container">
        <view class="confetti" wx:for="{{[1,2,3,4,5,6,7,8]}}" wx:key="index"></view>
      </view>
    </view>
  </view>

  <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
  <view class="status-indicator">
    <view class="status-dot {{isRunning ? 'active' : 'paused'}}" style="background-color: {{themeColor}}"></view>
    <text class="status-text">{{isRunning ? 'ä¸“æ³¨ä¸­' : (isPaused ? 'å·²æš‚åœ' : 'å‡†å¤‡å¼€å§‹')}}</text>
  </view>

  <!-- ç›®æ ‡è¿›åº¦å¡ç‰‡ -->
  <view class="goal-progress-card card" wx:if="{{goalProgress}}" bindtap="goToGoals">
    <view class="goal-header">
      <text class="goal-title">ğŸ“Š ä»Šæ—¥è¿›åº¦</text>
      <text class="goal-setting-btn">è®¾å®š ></text>
    </view>
    
    <!-- æ¯æ—¥ç›®æ ‡ -->
    <view class="goal-item" wx:if="{{goalProgress.daily.enabled}}">
      <view class="goal-info">
        <text class="goal-label">æ¯æ—¥ç›®æ ‡</text>
        <text class="goal-numbers">{{goalProgress.daily.current}}/{{goalProgress.daily.target}}åˆ†é’Ÿ</text>
      </view>
      <view class="goal-progress-bar">
        <view class="goal-progress-fill {{goalProgress.daily.achieved ? 'achieved' : ''}}"
              style="width: {{goalProgress.daily.percentage}}%; background-color: {{themeColor}}">
        </view>
      </view>
      <text class="goal-percentage" style="color: {{themeColor}}">{{goalProgress.daily.percentage}}%</text>
    </view>

    <!-- æ¯å‘¨ç›®æ ‡ -->
    <view class="goal-item" wx:if="{{goalProgress.weekly.enabled}}">
      <view class="goal-info">
        <text class="goal-label">æ¯å‘¨ç›®æ ‡</text>
        <text class="goal-numbers">{{goalProgress.weekly.current}}/{{goalProgress.weekly.target}}åˆ†é’Ÿ</text>
      </view>
      <view class="goal-progress-bar">
        <view class="goal-progress-fill {{goalProgress.weekly.achieved ? 'achieved' : ''}}"
              style="width: {{goalProgress.weekly.percentage}}%; background-color: {{themeColor}}">
        </view>
      </view>
      <text class="goal-percentage" style="color: {{themeColor}}">{{goalProgress.weekly.percentage}}%</text>
    </view>
  </view>

  <!-- è®¡æ—¶å™¨ä¸»ä½“ -->
  <view class="timer-container scale-in">
    <!-- ç¯å½¢è®¡æ—¶å™¨ -->
    <view class="timer-circle" wx:if="{{timerStyle === 'circle'}}">
      <view class="timer-ring">
        <canvas type="2d" id="progressRing" class="progress-ring"></canvas>
        <view class="timer-background"></view>
        <view class="timer-content">
          <view class="timer-display" style="color: {{themeColor}}">{{timerText}}</view>
          <view class="timer-label">{{timerLabel}}</view>
        </view>
      </view>
    </view>

    <!-- ç›´çº¿è®¡æ—¶å™¨ -->
    <view class="timer-line" wx:elif="{{timerStyle === 'line'}}">
      <view class="timer-content">
        <view class="timer-display" style="color: {{themeColor}}">{{timerText}}</view>
        <view class="timer-label">{{timerLabel}}</view>
      </view>
      <view class="progress-container">
        <canvas type="2d" id="progressLine" class="progress-line"></canvas>
      </view>
    </view>

    <!-- æç®€è®¡æ—¶å™¨ -->
    <view class="timer-minimal" wx:elif="{{timerStyle === 'minimal'}}">
      <view class="timer-content">
        <view class="timer-display" style="color: {{themeColor}}">{{timerText}}</view>
        <view class="timer-label">{{timerLabel}}</view>
      </view>
    </view>
  </view>

  <!-- æ§åˆ¶æŒ‰é’® -->
  <view class="controls slide-up">
    <button class="control-btn reset-btn" bindtap="resetTimer">
      <view class="btn-icon">
        <image src="/images/reset.png" mode="aspectFit"></image>
      </view>
      <text class="btn-text">é‡ç½®</text>
    </button>

    <button class="control-btn main-btn {{isRunning ? 'pause' : 'start'}}" bindtap="toggleTimer">
      <view class="btn-icon main">
        <image src="{{isRunning ? '/images/pause.png' : '/images/play.png'}}" mode="aspectFit"></image>
      </view>
    </button>
  </view>

  <!-- æ¨¡å¼åˆ‡æ¢ -->
  <view class="mode-tabs card">
    <view class="tab {{currentMode === 'focus' ? 'active' : ''}}"
          data-mode="focus" bindtap="switchMode"
          style="{{currentMode === 'focus' ? 'background-color:' + themeColor : ''}}">
      <text class="tab-icon">ğŸ¯</text>
      <text class="tab-text">ä¸“æ³¨</text>
    </view>
    <view class="tab {{currentMode === 'shortBreak' ? 'active' : ''}}"
          data-mode="shortBreak" bindtap="switchMode"
          style="{{currentMode === 'shortBreak' ? 'background-color:' + themeColor : ''}}">
      <text class="tab-icon">â˜•</text>
      <text class="tab-text">çŸ­ä¼‘æ¯</text>
    </view>
    <view class="tab {{currentMode === 'longBreak' ? 'active' : ''}}"
          data-mode="longBreak" bindtap="switchMode"
          style="{{currentMode === 'longBreak' ? 'background-color:' + themeColor : ''}}">
      <text class="tab-icon">ğŸ›‹ï¸</text>
      <text class="tab-text">é•¿ä¼‘æ¯</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ‘˜è¦ -->
  <view class="stats-summary card">
    <view class="stats-header">
      <text class="stats-title">ä»Šæ—¥ç»Ÿè®¡</text>
    </view>
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-value" style="color: {{themeColor}}">{{todayCompleted}}</view>
        <view class="stat-label">å®Œæˆæ¬¡æ•°</view>
      </view>
      <view class="stat-item">
        <view class="stat-value" style="color: {{themeColor}}">{{todayFocusTime}}</view>
        <view class="stat-label">ä¸“æ³¨æ—¶é•¿</view>
      </view>
      <view class="stat-item">
        <view class="stat-value" style="color: {{themeColor}}">{{weekCompleted}}</view>
        <view class="stat-label">æœ¬å‘¨å®Œæˆ</view>
      </view>
    </view>
  </view>
</view>